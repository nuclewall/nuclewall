<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE packagegui SYSTEM "../schema/packages.dtd">
<?xml-stylesheet type="text/xsl" href="../xsl/package.xsl"?>
<packagegui>
	<name>squidguardacl</name>
	<title>PROXY WEB FILTER: CUSTOM ACCESS RULES</title>
	<include_file>/usr/local/pkg/squidguard.inc</include_file>
	<tabs>
		<tab>
			<text>General</text>
			<url>/pkg_edit.php?xml=squid.xml&amp;id=0</url>
		</tab>
		<tab>
			<text>Cache</text>
			<url>/pkg_edit.php?xml=squid_cache.xml&amp;id=0</url>
		</tab>
		<tab>
			<text>General Filter Rules</text>
			<url>/pkg_edit.php?xml=squidguard_default.xml&amp;id=0</url>
		</tab>
		<tab>
			<text>Custom Filter Rules</text>
			<url>/pkg.php?xml=squidguard_acl.xml</url>
			<active/>
		</tab>
	</tabs>
	<adddeleteeditpagefields>
                <columnitem>
                        <fielddescr>Disabled</fielddescr>
                        <fieldname>disabled</fieldname>
                </columnitem>
                <columnitem>
                        <fielddescr>Name</fielddescr>
                        <fieldname>name</fieldname>
                </columnitem>
                <columnitem>
                        <fielddescr>Description</fielddescr>
                        <fieldname>description</fieldname>
                </columnitem>
	</adddeleteeditpagefields>
	<fields>
		<field>
			<fielddescr>Disabled</fielddescr>
			<fieldname>disabled</fieldname>
			<description>Check this to disable this ACL rule.</description>
			<type>checkbox</type>
		</field>
		<field>
			<fielddescr>Name</fielddescr>
			<fieldname>name</fieldname>
			<description>Enter a unique name of this rule here.&lt;br&gt;
			  The name must consist between 2 and 15 symbols [a-Z_0-9]. The first one must be a letter.
			</description>
			<type>input</type>
			<class>input-medium</class>
			<required/>
		</field>
		<field>
			<fielddescr>Client (source)</fielddescr>
			<fieldname>source</fieldname>
			<description>
			  Enter client's IP address or domain here. To separate them use space.&lt;br&gt;
			  Examples:&lt;br&gt;
			  IP: 192.168.0.1&lt;br&gt;
			  Subnet: 192.168.0.0/24 or 192.168.1.0/255.255.255.0 &lt;br&gt;
			  IP-Range: 192.168.1.1-192.168.1.10&lt;br&gt;
			  Domain: foo.bar, *.foo.bar&lt;br&gt;
              &lt;i&gt;Attention: these line don't have break line, all on one line&lt;/i&gt;
			</description>
			<type>input</type>
			<class>input-xxlarge</class>
		</field>
		<field>
			<fielddescr>Description</fielddescr>
			<fieldname>description</fieldname>
			<description>You may enter any description here for your reference</description>
			<type>input</type>
			<class>input-xxlarge</class>
		</field>
		<field>
			<fielddescr>Target Rules</fielddescr>
			<fieldname>dest</fieldname>
			<description></description>
			<type>input</type>
			<class>input-xxlarge</class>
		</field>
	</fields>
	<custom_php_validation_command>
		squidguard_validate_acl(&amp;$_POST, &amp;$input_errors);
	</custom_php_validation_command>
	<custom_php_command_before_form>
		squidguard_before_form_acl(&amp;$pkg);
	</custom_php_command_before_form>
	<custom_php_after_form_command>
		squidGuard_print_javascript();
	</custom_php_after_form_command>
	<custom_php_resync_config_command>
		squidguard_resync_acl();
		if (is_process_running('squidGuard'))
			squidguard_resync();
	</custom_php_resync_config_command>
	<custom_delete_php_command>
		squidguard_resync_acl();
		if (is_process_running('squidGuard'))
			squidguard_resync();
	</custom_delete_php_command>
</packagegui>
