<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE packagegui SYSTEM "../schema/packages.dtd">
<?xml-stylesheet type="text/xsl" href="../xsl/package.xsl"?>
<packagegui>
    <description>Describe your package here</description>
    <requirements>Describe your package requirements here</requirements>
    <faq>Currently there are no FAQ items provided.</faq>
	<name>squidcache</name>
	<version>none</version>
	<title>PROXY SERVER: CACHE MANAGEMENT</title>
	<include_file>/usr/local/pkg/squid.inc</include_file>
	<tabs>
		<tab>
			<text>General</text>
			<url>/pkg_edit.php?xml=squid.xml&amp;id=0</url>
		</tab>
		<tab>
			<text>Cache</text>
			<url>/pkg_edit.php?xml=squid_cache.xml&amp;id=0</url>
			<active/>
		</tab>
		<tab>
			<text>General Filter Rules</text>
			<url>/pkg_edit.php?xml=squidguard_default.xml&amp;id=0</url>
		</tab>
		<tab>
			<text>Custom Filter Rules</text>
			<url>/pkg.php?xml=squidguard_acl.xml</url>
		</tab>
	</tabs>
	<fields>
		<field>
			<fielddescr>Hard Disk Cache Size</fielddescr>
			<fieldname>harddisk_cache_size</fieldname>
			<description>This is the amount of disk space (in megabytes) to use for cached objects.</description>
			<type>input</type>
			<required/>
			<default_value>4096</default_value>
			<class>input-small</class>
		</field>
		<field>
			<fielddescr>Hard Disk Cache Location</fielddescr>
			<fieldname>harddisk_cache_location</fieldname>
			<description>This is the directory where the cache will be stored. (note: do not end with a /).
			 If you change this location, squid needs to make a new cache, this could take a while</description>
			<type>input</type>
			<class>input-medium</class>
			<required/>
			<default_value>/var/squid/cache</default_value>
		</field>
		<field>
			<fielddescr>Memory Cache Size</fielddescr>
			<fieldname>memory_cache_size</fieldname>
			<description>This is the amount of physical RAM (in megabytes) to be used for negative cache and in-transit objects.
			This value should not exceed more than 50% of the installed RAM. The minimum value is 1MB.</description>
			<type>input</type>
			<required/>
			<default_value>8</default_value>
			<class>input-small</class>
		</field>
		<field>
			<fielddescr>Minimum Object Size</fielddescr>
			<fieldname>minimum_object_size</fieldname>
			<description>Objects smaller than the size specified (in kilobytes) will not be saved on disk.
			 The default value is 0, meaning there is no minimum.</description>
			<type>input</type>
			<required />
			<default_value>0</default_value>
			<class>input-small</class>
		</field>
		<field>
			<fielddescr>Maximum Object Size</fielddescr>
			<fieldname>maximum_object_size</fieldname>
			<description>Objects larger than the size specified (in kilobytes) will not be saved on disk.
			 If you wish to increase speed more than you want to save bandwidth, this should be set to a low value.</description>
			<type>input</type>
			<required/>
			<default_value>1024</default_value>
			<class>input-small</class>
		</field>
		<field>
			<fielddescr>Maximum object size in RAM</fielddescr>
			<fieldname>maximum_objsize_in_mem</fieldname>
			<description>Objects smaller than the size specified (in kilobytes) will be saved in RAM. Default is 32</description>
			<type>input</type>
			<required/>
			<default_value>32</default_value>
			<class>input-small</class>
		</field>
		<field>
			<fielddescr>Level 1 Subdirectories</fielddescr>
			<fieldname>level1_subdirs</fieldname>
			<description>Each level-1 directory contains 256 subdirectories,
			o a value of 256 level-1 directories will use a total of 65536 directories for the hard disk cache.
			This will significantly slow down the startup process of the proxy service,
			but can speed up the caching under certain conditions.</description>
			<type>select</type>
			<default_value>16</default_value>
			<options>
				<option><name>4</name><value>4</value></option>
				<option><name>8</name><value>8</value></option>
				<option><name>16</name><value>16</value></option>
				<option><name>32</name><value>32</value></option>
				<option><name>64</name><value>64</value></option>
				<option><name>128</name><value>128</value></option>
				<option><name>256</name><value>256</value></option>
			</options>
		</field>
	</fields>
	<custom_php_command_before_form>
		if($_POST['harddisk_cache_size'] != $config['installedpackages']['squidcache']['config'][0]['harddisk_cache_size']) {
			$needs_dash_z = true;
		}
	</custom_php_command_before_form>
	<custom_php_validation_command>
		squid_validate_cache($_POST, &amp;$input_errors);
	</custom_php_validation_command>
	<custom_php_resync_config_command>
		squid_resync();
		if($needs_dash_z)
		squid_dash_z();
	</custom_php_resync_config_command>
</packagegui>
