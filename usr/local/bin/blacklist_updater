#!/usr/local/bin/php -q
<?php
/*
	blacklist_updater

	Copyright (C) 2013-2020 Ogün AÇIK
	All rights reserved.
*/

require('/usr/local/pkg/squidguard_configurator.inc');

$hash_file = '/var/db/blacklist_hash';
$update = false;
$latest_hash = exec("curl http://www.shallalist.de/Downloads/shallalist.tar.gz.md5 | awk '{print $1}' ");

if(file_exists($hash_file))
{
	$local_hash = file_get_contents($hash_file);

	if($latest_hash != $local_hash)
	{
		$update = true;
		file_put_contents($hash_file, $latest_hash);
	}
}

else
{
	$update = true;
	file_put_contents($hash_file, $latest_hash);
}

if($update)
	sg_reconfigure_blacklist("http://www.shallalist.de/Downloads/shallalist.tar.gz");

?>
